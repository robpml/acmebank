angular.module("sample",["ngRoute","ngCkeditor","ui.bootstrap","ngJsonExplorer","hljs","highcharts-ng","ml.common","ml.search","ml.search.tpls","ml.utils","sample.user","sample.search","sample.charts","sample.common","sample.detail","sample.create"]).config(["$routeProvider","$locationProvider","mlMapsProvider",function(e,t,r){"use strict";t.html5Mode(!0),e.when("/",{templateUrl:"/search/search.html",controller:"SearchCtrl",reloadOnSearch:!1}).when("/create",{templateUrl:"/create/create.html",controller:"CreateCtrl"}).when("/charts",{templateUrl:"/charts/charts.html",controller:"ChartsCtrl"}).when("/detail",{templateUrl:"/detail/detail.html",controller:"DetailCtrl"}).when("/profile",{templateUrl:"/user/profile.html",controller:"ProfileCtrl"}).otherwise({redirectTo:"/"})}]),function(){"use strict";angular.module("sample.charts").controller("ChartsCtrl",["$scope","$http","$location","User","MLSearchFactory","MLRemoteInputService",function(e,t,r,a,n,o){function l(t){u.search=t,u.qtext=s.getText(),u.page=s.getPage(),o.setInput(u.qtext),r.search(s.getParams());var a=[];u.search&&u.search.facets&&u.search.facets["Trade operation"]&&angular.forEach(u.search.facets["Trade operation"].facetValues,function(e,t){a.push(e.count)}),e.chartConfig.series=[{data:a}]}function i(e){return u.user.authenticated?(arguments.length&&(u.qtext=e),void s.setText(u.qtext).setPage(u.page).search().then(l)):void(u.search={})}var s=n.newContext(),u={page:1,qtext:"",search:{},user:a};!function(){o.initCtrl(e,u,s,i),e.$watch("model.user.authenticated",function(){i()}),s.fromParams().then(function(){s.setText(u.qtext),l({})}),e.$on("$locationChangeSuccess",function(e,t,r){s.locationChange(t,r).then(function(){i()})})}(),angular.extend(e,{model:u,search:i,toggleFacet:function(e,t){s.toggleFacet(e,t).search().then(l)},chartConfig:{options:{chart:{type:"column"},tooltip:{style:{padding:10,fontWeight:"bold"}}},title:{text:"Cancelled Trades per day"},loading:!1,xAxis:{currentMin:0,currentMax:20,title:{text:"Trade status pre-cancel"}},useHighStocks:!1,size:{width:400,height:300},func:function(e){}},chartConfig2:{options:{tooltip:{style:{padding:10,fontWeight:"bold"}}},series:[{type:"column",name:"Jane",data:[3,2,1,3,4,3,2,5,6,2,5,1]},{type:"column",name:"John",data:[2,3,5,7,6,4,3,2,1,2,3,4]},{type:"column",name:"Joe",data:[4,3,3,9,0,10,11,14,18,20,22,40]},{type:"spline",name:"Average",data:[3,2.67,3,6.33,3.33,4.2,5,6,7,8,9,15]},{type:"pie",name:"Total cancelled trades",data:[{name:"Jane",y:13,color:Highcharts.getOptions().colors[0]},{name:"John",y:23,color:Highcharts.getOptions().colors[1]},{name:"Joe",y:135,color:Highcharts.getOptions().colors[2]}],center:[100,80],size:100,showInLegend:!1,dataLabels:{enabled:!1}}],title:{text:"Cancelled Trades per month"},loading:!1,xAxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],title:{text:"Month"}},yAxis:{title:{text:"Cancelled trades"}},useHighStocks:!1,size:{width:700,height:400},func:function(e){}},chartConfig3:{options:{chart:{type:"spline",events:{load:function(){var e=this.series[0];setInterval(function(){var t=(new Date).getTime(),r=Math.random();e.addPoint([t,r],!0,!0)},1e3)}}},tooltip:{style:{padding:10,fontWeight:"bold"}}},series:[{data:function(){var e,t=[],r=(new Date).getTime();for(e=0;19>=e;e+=1)t.push({x:r+e,y:Math.random()});return t}()}],title:{text:"Book Value ($USD)"},loading:!1,xAxis:{type:"datetime",tickPixelInterval:150,title:{text:"values"}},yAxis:{title:{text:"Value"},plotLines:[{value:0,width:1,color:"#808080"}]},useHighStocks:!1,size:{width:400,height:300},func:function(e){}},chartConfig4:{options:{chart:{type:"column"},tooltip:{style:{padding:10,fontWeight:"bold"}}},title:{text:"Data from ML"},loading:!1,xAxis:{currentMin:0,currentMax:2e4,title:{text:"values"}},useHighStocks:!1,size:{width:400,height:300},func:function(e){}},chartConfig5:{options:{zoomType:"xy"},title:{text:"SoyaBean Futures ($USD) / Temperature & Rainfall",floating:!0,align:"left",x:100,y:20},subtitle:{text:"Source: WorldClimate.com",floating:!0,align:"left",x:100,y:40},xAxis:[{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],crosshair:!0}],yAxis:[{labels:{format:"{value}°C",style:{color:Highcharts.getOptions().colors[2]}},title:{text:"Temperature",style:{color:Highcharts.getOptions().colors[2]}},opposite:!0},{gridLineWidth:0,title:{text:"Rainfall",style:{color:Highcharts.getOptions().colors[0]}},labels:{format:"{value} mm",style:{color:Highcharts.getOptions().colors[0]}}},{gridLineWidth:0,title:{text:"Futures ($USD)",style:{color:Highcharts.getOptions().colors[1]}},labels:{format:"{value} $USD",style:{color:Highcharts.getOptions().colors[1]}},opposite:!0}],tooltip:{shared:!0},legend:{layout:"vertical",align:"left",x:200,verticalAlign:"top",y:55,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.legendBackgroundColor||"#FFFFFF"},size:{width:800,height:300},series:[{name:"Rainfall",type:"column",yAxis:1,data:[49.9,71.5,106.4,129.2,144,176,135.6,148.5,216.4,194.1,95.6,54.4],tooltip:{valueSuffix:" mm"}},{name:"Futures ($USD)",type:"spline",yAxis:2,data:[910,920,940,930,970,910,1050,1045,1020,1016,975,985],marker:{enabled:!1},dashStyle:"shortdot",tooltip:{valueSuffix:" $USD"}},{name:"Temperature",type:"spline",data:[7,6.9,9.5,14.5,18.2,21.5,25.2,26.5,23.3,18.3,13.9,9.6],tooltip:{valueSuffix:" °C"}}]}})}])}(),angular.module("sample.charts",[]),angular.module("sample.common",[]).filter("object2Array",function(){"use strict";return function(e){var t=[];for(var r in e)e[r].__key=r,t.push(e[r]);return t}}),angular.module("sample.create").directive("compile",function(e){"use strict";return function(t,r,a){t.$watch(function(e){return e.$eval(a.compile)},function(a){r.html(a),e(r.contents())(t)})}}),function(){"use strict";angular.module("sample.create").controller("CreateCtrl",["$scope","MLRest","$window","User",function(e,t,r,a){var n={person:{isActive:!0,balance:0,picture:"http://placehold.it/32x32",age:0,eyeColor:"",name:"",gender:"",company:"",email:"",phone:"",address:"",about:"",registered:"",latitude:0,longitude:0,tags:[],friends:[],greeting:"",favoriteFruit:""},newTag:"",user:a};angular.extend(e,{model:n,editorOptions:{height:"100px",toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"}],toolbar:"",toolbar_full:""},submit:function(){t.createDocument(e.model.person,{format:"json",directory:"/content/",extension:".json"}).then(function(e){r.location.href="/detail?uri="+e.replace(/(.*\?uri=)/,"")})},addTag:function(){n.person.tags.push(n.newTag),n.newTag=""}})}])}(),angular.module("sample.create",[]),function(){"use strict";angular.module("sample.detail").controller("DetailCtrl",["$scope","$http","MLRest","$routeParams",function(e,t,r,a){var n=a.uri,o={uri:n,detail:{}};r.getDocument(n,{format:"json",transform:"indent"}).then(function(e){o.detail=e.data}),angular.extend(e,{model:o})}])}(),angular.module("sample.detail",[]),function(){"use strict";angular.module("sample.detail").controller("DetailCtrl",["$scope","MLRest","$routeParams",function(e,t,r){var a=r.uri,n={detail:{}};t.getDocument(a,{format:"json",transform:"indent"}).then(function(e){n.detail=e.data}),angular.extend(e,{model:n})}])}(),angular.module("sample.detail",[]),function(){"use strict";angular.module("sample.search").controller("SearchCtrl",["$scope","$location","User","MLSearchFactory","MLRemoteInputService",function(e,t,r,a,n){function o(e){s.search=e,s.qtext=i.getText(),s.page=i.getPage(),n.setInput(s.qtext),t.search(i.getParams())}function l(e){return s.user.authenticated?(arguments.length&&(s.qtext=e),void i.setText(s.qtext).setPage(s.page).search().then(o)):void(s.search={})}var i=a.newContext(),s={page:1,qtext:"",search:{},user:r};!function(){n.initCtrl(e,s,i,l),e.$watch("model.user.authenticated",function(){l()}),i.fromParams().then(function(){i.setText(s.qtext),o({})}),e.$on("$locationChangeSuccess",function(e,t,r){i.locationChange(t,r).then(function(){l()})})}(),angular.extend(e,{model:s,search:l,toggleFacet:function(e,t){i.toggleFacet(e,t).search().then(o)}})}])}(),angular.module("sample.search",[]),function(){"use strict";angular.module("sample.user").controller("ProfileCtrl",["$scope","MLRest","User","$location",function(e,t,r,a){var n={user:r,newEmail:""};angular.extend(e,{model:n,addEmail:function(){e.profileForm.newEmail.$error.email||(e.model.user.emails||(e.model.user.emails=[]),e.model.user.emails.push(n.newEmail),n.newEmail="")},removeEmail:function(t){e.model.user.emails.splice(t,1)},submit:function(){t.updateDocument({user:{fullname:e.model.user.fullname,emails:e.model.user.emails}},{format:"json",uri:"/users/"+e.model.user.name+".json"}).then(function(e){a.path("/")})}})}])}(),function(){"use strict";angular.module("sample.user").directive("mlUser",[function(){return{restrict:"EA",controller:"UserController",replace:!0,scope:{},templateUrl:"/user/user-dir.html"}}]).controller("UserController",["$scope","User",function(e,t){angular.extend(e,{user:t,login:t.login,logout:function(){t.logout(),e.password=""}})}])}(),function(){"use strict";angular.module("sample.user").factory("User",["$http",function(e){function t(){return a.name="",a.password="",a.loginError=!1,a.authenticated=!1,a.hasProfile=!1,a.fullname="",a.emails=[],a}function r(e){var t=e.data;a.authenticated=t.authenticated,a.authenticated&&(a.name=t.username,t.profile&&(a.hasProfile=!0,a.fullname=t.profile.fullname,_.isArray(t.profile.emails)?a.emails=t.profile.emails:a.emails=[t.profile.emails]))}var a={};return t(),e.get("/user/status",{}).then(r),angular.extend(a,{login:function(t,n){e.get("/user/login",{params:{username:t,password:n}}).then(function(e){r(e),a.loginError=!a.authenticated})},logout:function(){e.get("/user/logout").then(t)}}),a}])}(),angular.module("sample.user",["sample.common"]),function(){"use strict";angular.module("sample.common").factory("MLSampleQueryBuilder",[function(){var e=function(){return 1===arguments.length&&angular.isArray(arguments[0])?{"and-query":{queries:arguments[0]}}:{"and-query":{queries:Array.prototype.slice.call(arguments)}}};return{andQuery:e,boostQuery:function(t,r){return t?{"boost-query":{"matching-query":t,"boosting-query":r}}:{"boost-query":{"matching-query":e(),"boosting-query":r}}},collectionConstraintQuery:function(e,t){return{"collection-constraint-query":{"constraint-name":e,uri:Array.isArray(t)?t:[t]}}},customConstraintQuery:function(e,t){return{"custom-constraint-query":{"constraint-name":e,text:t}}},customGeospatialConstraintQuery:function(e,t,r){return{"custom-constraint-query":{"constraint-name":e,annotation:t,box:r}}},documentQuery:function(e){return{"document-query":{uri:Array.isArray(e)?e:[e]}}},geospatialConstraintQuery:function(e,t){return{"geospatial-constraint-query":{"constraint-name":e,box:t}}},operatorState:function(e,t){return{"operator-state":{"operator-name":e,"state-name":t}}},orQuery:function(){return 1===arguments.length&&angular.isArray(arguments[0])?{"or-query":{queries:arguments[0]}}:{"or-query":{queries:Array.prototype.slice.call(arguments)}}},propertiesQuery:function(e){return{"properties-query":e}},rangeConstraintQuery:function(e,t,r,a){return a||(a=[]),t||(t="EQ"),{"range-constraint-query":{"constraint-name":e,"range-operator":t,value:r,"range-option":a}}},structuredQuery:function(){return 1===arguments.length&&angular.isArray(arguments[0])?{query:{queries:arguments[0]}}:{query:{queries:Array.prototype.slice.call(arguments)}}},termQuery:function(e,t){return t?{"term-query":{text:e,weight:t}}:{"term-query":{text:e}}},textQuery:function(e){return{qtext:e}}}}])}();